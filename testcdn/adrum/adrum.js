!function(){"use strict";var e,t,n={9513:function(e,t,n){n.d(t,{T:function(){return o},_:function(){return s}});var i=n(6336);const r=["/eum/v1/logs","/eum/v1/traces","/eum/v1/config"],o=(e,t)=>{var n,o,s,a,u,l,c,d,g,f,h,m,v,p,y,w,E,b,T,S,I,O,R,N,C,M,_,L,P,A,F,D,k,x,j;const B=r.map((t=>(0,i.c)({baseUrl:e.url,discardExistingPath:!0,pathName:t}).toString())),G=Object.assign(Object.assign({},t),{apiConfig:{appName:e.appName,appVersion:null!==(n=e.appVersion)&&void 0!==n?n:null,aura:null!==(o=e.aura)&&void 0!==o&&o,disableLateResources:null!==(s=e.disableLateResources)&&void 0!==s&&s,exportersForDebug:null!==(a=e.exportersForDebug)&&void 0!==a&&a,exportForTests:null!==(u=e.exportForTests)&&void 0!==u&&u,exportInterval:null!==(l=e.exportInterval)&&void 0!==l?l:5e3,exportTimeout:null!==(c=e.exportTimeout)&&void 0!==c?c:3e4,ignoreUrlsForFetch:(null!==(d=e.ignoreUrlsForFetch)&&void 0!==d?d:[]).concat(B),ignoreUrlsForResource:(null!==(g=e.ignoreUrlsForResource)&&void 0!==g?g:[]).concat(B),ignoreUrlsForXhr:(null!==(f=e.ignoreUrlsForXhr)&&void 0!==f?f:[]).concat(B),logLevel:null!==(h=e.logLevel)&&void 0!==h?h:"error",networkErrorTimeoutDuration:null!==(m=e.networkErrorTimeoutDuration)&&void 0!==m?m:3e5,sessionReplay:{iframeDiscoverParentTimeout:null!==(p=null===(v=e.sessionReplay)||void 0===v?void 0:v.iframeDiscoverParentTimeout)&&void 0!==p?p:1e3,iframes:null!==(w=null===(y=e.sessionReplay)||void 0===y?void 0:y.iframes)&&void 0!==w&&w,maskAllInputs:null===(b=null===(E=e.sessionReplay)||void 0===E?void 0:E.maskAllInputs)||void 0===b||b,maskAllText:null===(S=null===(T=e.sessionReplay)||void 0===T?void 0:T.maskAllText)||void 0===S||S,packAssets:null!==(O=null===(I=e.sessionReplay)||void 0===I?void 0:I.packAssets)&&void 0!==O&&O,periodicDOMSnapshotInterval:null!==(N=null===(R=e.sessionReplay)||void 0===R?void 0:R.periodicDOMSnapshotInterval)&&void 0!==N?N:3e5,sensitivityRules:null!==(M=null===(C=e.sessionReplay)||void 0===C?void 0:C.sensitivityRules)&&void 0!==M?M:[]},storageKeys:{immatureSpan:null!==(L=null===(_=e.storageKeys)||void 0===_?void 0:_.immatureSpan)&&void 0!==L?L:"adrum_immature_span",metadata:null!==(A=null===(P=e.storageKeys)||void 0===P?void 0:P.metadata)&&void 0!==A?A:"adrum_data",queuedChunks:null!==(D=null===(F=e.storageKeys)||void 0===F?void 0:F.queuedChunks)&&void 0!==D?D:"adrum_queued_chunks",timeout:null!==(x=null===(k=e.storageKeys)||void 0===k?void 0:k.timeout)&&void 0!==x?x:"adrum_timeout"},url:e.url,useZoneContext:null!==(j=e.useZoneContext)&&void 0!==j&&j},sessionReplay:Object.assign(Object.assign({},t.sessionReplay),{recordingEnabled:Boolean(t.sessionReplay.recordingEnabled)})});return Object.assign(Object.assign({},G),{projectKey:`${G.apiConfig.appName};${G.apiConfig.url}`})},s={brum:{maxSessionLength:3600,recordingEnabled:!0,sessionTimeout:900},sessionReplay:{recordingEnabled:!1}}},718:function(e,t,n){n.d(t,{TD:function(){return d},d0:function(){return a},g7:function(){return o},gC:function(){return s}});var i=n(5391),r=n(607);const o=["mask","unmask","exclude"],s=e=>e.replace(/\S/gi,"*"),a=(e,t)=>({isPasswordInput:(0,i.B6)(e)&&"password"===e.type,sensitivityRuleType:u(e,t)}),u=(e,t=[])=>{let n=null;const i=[...t].reverse();for(const t of i){if(l(t.selector).some(c(e))){n=t.rule;break}}return n},l=e=>e.split(",").flatMap((e=>[e,`${e} *`])),c=e=>t=>{const n=(0,i.vq)(e)?e:r.dC(e);return null!==n&&n.matches(t)},d=(e,t)=>{const n=Object.assign({},e);return t.isPasswordInput&&(n.isPasswordInput=!0),"exclude"!==n.sensitivityRuleType&&(n.sensitivityRuleType=t.sensitivityRuleType),n}},9015:function(e,t,n){n.d(t,{$:function(){return f}});var i,r=n(3589),o=n(5703),s=n(5474),a=n(3286),u=n(4693),l=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const c="adrum_browser_instance_id",d="adrum_browser_instance_id_available",g="adrum_browser_instance_id_taken";class f{static get id(){if(!this.isInitialized)throw new Error("Attempt to get id before BrowserInstanceService is initialized.");if((0,r.RT)()){if(!this._id)throw new TypeError("ID is not set");return this._id}if(!this.isCommunicationWithOtherTabsFinished)return o.R.warn("BrowserInstanceService: Communication with other tabs is not finished yet. Treating tab as a new tab and stopping communication."),this._id=s.$(),this._id;if(!this._id)throw new TypeError("ID is not set");return this._id}static initialize(){return l(this,void 0,void 0,(function*(){this.isInitialized?o.R.error("BrowserInstanceService: Unexpected - initialize called more than once"):(this.isInitialized=!0,window.addEventListener("storage",this.handleIdAvailableStorageEvent),yield this.assignId())}))}static initializeInIframe(e){(0,r.RT)()?this.isInitialized?o.R.error("BrowserInstanceService: Unexpected - initialize called more than once"):(this.isInitialized=!0,this._id=e):o.R.error("BrowserInstanceService: initializeInIframe should not be called outside of an iframe.")}static assignId(){return l(this,void 0,void 0,(function*(){var e;if(this._id=null!==(e=(0,a.Af)(c))&&void 0!==e?e:void 0,void 0===this._id)this._id=s.$(),o.R.debug("BrowserInstanceService: new tab identified",{id:this._id});else{(0,a.XV)(d,this._id);const e=performance.now();yield this.waitForIdTakenEvent(),o.R.debug("BrowserInstanceService: communication with other tabs finished",performance.now()-e),(0,a.hx)(d),(0,a.hx)(g)}this.isCommunicationWithOtherTabsFinished=!0,(0,a.ei)(c,this._id)}))}static waitForIdTakenEvent(){return new Promise((e=>{const t=window.setTimeout((()=>{o.R.debug("BrowserInstanceService: TAB_ID_TAKEN event not received in time."),window.removeEventListener("storage",n),e()}),100),n=i=>{(0,u.Q)(i)&&i.key===g&&i.newValue===this._id&&(this.isCommunicationWithOtherTabsFinished?o.R.error("BrowserInstanceService: duplicated tab identified but communication is already finished."):(this._id=s.$(),o.R.error("BrowserInstanceService: duplicated tab identified generating new ID",this._id),this.isCommunicationWithOtherTabsFinished=!0),window.removeEventListener("storage",n),clearTimeout(t),e())};window.addEventListener("storage",n)}))}}i=f,f.isCommunicationWithOtherTabsFinished=!1,f.isInitialized=!1,f.handleIdAvailableStorageEvent=e=>{e.key!==d||e.newValue!==i._id||(0,a.XV)(g,i._id)}},3906:function(e,t,n){n.d(t,{GX:function(){return r},MG:function(){return o},cS:function(){return u},g4:function(){return i},o7:function(){return s},yv:function(){return a}});var i;!function(e){e.ACKNOWLEDGED="APPD__ACKNOWLEDGED",e.DISCOVERY="APPD__DISCOVERY",e.DISCOVERED="APPD__DISCOVERED",e.GET_CONFIG="APPD__GET_CONFIG",e.GET_PROJECT_METADATA="APPD__GET_PROJECT_METADATA",e.GET_WINDOW_ID="APPD__GET_WINDOW_ID",e.WINDOW_ID="APPD__WINDOW_ID",e.CONFIG="APPD__CONFIG",e.PROJECT_METADATA="APPD__PROJECT_METADATA",e.START_SESSION="APPD__START_SESSION",e.STOP_SESSION="APPD__STOP_SESSION"}(i||(i={}));const r=e=>{if(e&&"object"==typeof e&&Object.hasOwn(e,"name")){const t=e.name;if("string"==typeof t&&t.startsWith("APPD__"))return!0}return!1},o=e=>e.name===i.DISCOVERY,s=e=>e.name===i.DISCOVERED,a=e=>e.name===i.GET_CONFIG,u=e=>e.name===i.START_SESSION},6022:function(e,t,n){n.d(t,{C:function(){return a}});var i,r=n(4141),o=n(3589);const s=(0,r.i)("script-mode-service");class a{static initialize(){this.isInitialized?s.error("Initialize called more than once"):(this.isInitialized=!0,(0,o.RT)()||(this.mode="normal"))}static get isPendingMode(){return"pending"===this.mode}static get isNormalMode(){return"normal"===this.mode}static get isRestrictedMode(){return"restricted"===this.mode}static get isCrossOriginIframeMode(){return"cross-origin-iframe"===this.mode}static get isReady(){return"pending"!==this.mode}static get mode(){if(!this.isInitialized)throw new Error("Attempt to get mode before ScriptModeService is initialized.");return this._mode}static set mode(e){this._mode=e,s.debug(`Mode changed to "${e}".`)}}i=a,a._mode="pending",a.isInitialized=!1,a.setCrossOriginIframeMode=()=>{i.mode="cross-origin-iframe"},a.setNormalMode=()=>{i.mode="normal"},a.setRestrictedMode=()=>{i.mode="restricted"}},6336:function(e,t,n){n.d(t,{c:function(){return i}});const i=({baseUrl:e,discardExistingPath:t,pathName:n})=>{const i=new URL((e=>/^https?:\/\//.test(e)?e:`https://${e}`)(e));if(!n)return i;if(t)return new URL(n,i.origin);{let e=i.pathname;return e.endsWith("/")&&n.startsWith("/")&&(e=e.slice(0,-1)),new URL(`${e}${n}`,i.origin)}}},4318:function(e,t,n){n.d(t,{y:function(){return i}});const i=e=>e.location.search.toLowerCase().includes("adrum_debug=true")},2376:function(e,t,n){n.d(t,{o:function(){return i}});const i=(e,...t)=>console.warn(`[ADRUM]: ${e}`,...t)},7599:function(e,t,n){n.d(t,{OM:function(){return a},cS:function(){return u},gU:function(){return c},jH:function(){return s}});var i=n(3589),r=n(5046),o=n(1802);const s=()=>(0,i.NM)()?window.parent.location.href:"unknown",a=()=>window.parent===window.top?r.g$.BASE_PAGE:r.g$.IFRAME;function u(e,t){for(const n of t)if(n instanceof RegExp){if(n.test(e))return!0}else if("string"==typeof n&&e.includes(n))return!0;return!1}const l=new Set(["http:","https:"]),c=e=>{if(!(0,o.Kg)(e))return!1;try{const t=new URL(e);if(!l.has(t.protocol))throw new TypeError("Unsupported protocol")}catch(e){return!1}return!0}},5703:function(e,t,n){var i;n.d(t,{R:function(){return o}}),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(i||(i={}));class r{groupLoggingIntervalId=null;groupsByKey=new Map;isGroupLoggingEnabled=!1;loggingLevel=null;middlewares=[];constructor(){}debug=(e,...t)=>{this.processMiddlewares("console","debug",e,...t),null!==this.loggingLevel&&i.DEBUG>=this.loggingLevel&&console.debug(e,...t)};debugGroup=(e,...t)=>{this.isGroupLoggingEnabled?null!==this.loggingLevel&&i.DEBUG>=this.loggingLevel&&this.pushToGroup("debug",e,...t):this.debug(e,...t)};debugNoConsole=(e,...t)=>{this.processMiddlewares("internal","debug",e,...t)};enableGroupLogging=()=>{this.isGroupLoggingEnabled=!0,null!==this.groupLoggingIntervalId&&(this.groupLoggingIntervalId=setInterval((()=>{const e=this.groupsByKey;this.groupsByKey=new Map;for(const[t,n]of e.entries()){console.groupCollapsed(t);for(const[e,...t]of n)console[e](...t);console.groupEnd()}}),1e3))};error=(e,...t)=>{this.processMiddlewares("console","error",e,...t),null!==this.loggingLevel&&i.ERROR>=this.loggingLevel&&console.error(e,...t)};errorGroup=(e,...t)=>{this.isGroupLoggingEnabled?null!==this.loggingLevel&&i.ERROR>=this.loggingLevel&&this.pushToGroup("error",e,...t):this.error(e,...t)};errorNoConsole=(e,...t)=>{this.processMiddlewares("internal","error",e,...t)};info=(e,...t)=>{this.processMiddlewares("console","info",e,...t),null!==this.loggingLevel&&i.INFO>=this.loggingLevel&&console.log(e,...t)};infoGroup=(e,...t)=>{this.isGroupLoggingEnabled?null!==this.loggingLevel&&i.INFO>=this.loggingLevel&&this.pushToGroup("info",e,...t):this.info(e,...t)};infoNoConsole=(e,...t)=>{this.processMiddlewares("internal","info",e,...t)};setLoggingLevel=e=>{this.loggingLevel=r.convertLogLevelToNumber(e)};setMiddleware=e=>{this.middlewares.push(e)};warn=(e,...t)=>{this.processMiddlewares("console","warn",e,...t),null!==this.loggingLevel&&i.WARN>=this.loggingLevel&&console.warn(e,...t)};warnGroup=(e,...t)=>{this.isGroupLoggingEnabled?null!==this.loggingLevel&&i.WARN>=this.loggingLevel&&this.pushToGroup("warn",e,...t):this.warn(e,...t)};warnNoConsole=(e,...t)=>{this.processMiddlewares("internal","warn",e,...t)};static convertLogLevelToNumber=e=>{switch(e){case"debug":return i.DEBUG;case"info":return i.INFO;case"warn":return i.WARN;default:return i.ERROR}};processMiddlewares=(e,t,n,...i)=>{this.middlewares.forEach((r=>r(e,t,n,...i)))};pushToGroup(e,t,...n){let i=this.groupsByKey.get(t);i||(i=[],this.groupsByKey.set(t,i)),i.push([e,...n])}}const o=new r},4141:function(e,t,n){n.d(t,{i:function(){return o},n:function(){return r}});var i=n(5703);const r=e=>["debug","info","warn","error"].includes(String(e)),o=e=>{const t=t=>`${e}: ${t}`;return{...i.R,debug:(e,...n)=>{i.R.debug(t(e),...n)},error:(e,...n)=>{i.R.error(t(e),...n)},info:(e,...n)=>{i.R.info(t(e),...n)},warn:(e,...n)=>{i.R.warn(t(e),...n)}}}},5046:function(e,t,n){var i,r,o,s;n.d(t,{Bx:function(){return i},ZE:function(){return r},f7:function(){return o},g$:function(){return s}}),function(e){e.VIRTUAL_PAGE_SPAN="Virtual_Page_Span",e.PAGE_VIEW="page_view",e.WEB_VITAL="web_vital"}(i||(i={})),function(e){e.DOCUMENT_LOAD="documentLoad",e.DOCUMENT_FETCH="documentFetch",e.RESOURCE_FETCH="resourceFetch"}(r||(r={})),function(e){e.FIRST_PAINT="firstPaint",e.FIRST_CONTENTFUL_PAINT="firstContentfulPaint"}(o||(o={})),function(e){e.BASE_PAGE="base_page",e.IFRAME="iframe",e.VIRTUAL_PAGE="virtual_page"}(s||(s={}))},4693:function(e,t,n){n.d(t,{B:function(){return r},Q:function(){return i}});const i=e=>void 0===e.isTrusted||e.isTrusted;var r;!function(e){e.SESSION_START="session_start",e.SESSION_PULSE="session_pulse"}(r||(r={}))},485:function(e,t,n){n.d(t,{O$:function(){return o},x:function(){return s}});var i=n(5391),r=n(5190);const o=e=>{var t,n,o,s;if((0,i.QU)(e))return!0;if((0,i.rh)(e))return!0;if((0,i.ir)(e)&&(null===e.previousSibling||null===e.nextSibling)&&(null!==(s=e).textContent&&!/[^\t\n\r ]/.test(s.textContent)))return!0;if((0,i.JL)(e)&&["manifest","preload","prefetch","modulepreload"].includes(null!==(t=e.getAttribute("rel"))&&void 0!==t?t:""))return!0;if((0,i.kH)(e)){if(["content-security-policy","refresh"].includes((null!==(n=e.getAttribute("http-equiv"))&&void 0!==n?n:"").toLowerCase()))return!0;if(["facebook-domain-verification","apple-itunes-app","google-site-verification"].includes((null!==(o=e.getAttribute("name"))&&void 0!==o?o:"").toLowerCase()))return!0}return!(!(0,i.JL)(e)||!((0,r.Jb)(e.href)||e.href.startsWith("blob:")&&"stylesheet"!==e.rel))},s=e=>!!(0,i.ST)(e)||!!(0,i.rh)(e)},5474:function(e,t,n){n.d(t,{$:function(){return i}});const i=()=>((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[e]];return t})()},191:function(e,t,n){n.d(t,{SW:function(){return o},ni:function(){return i},u5:function(){return r}});const i=e=>{var t,n;let i=null;try{i=null!==(n=null===(t=e.defaultView)||void 0===t?void 0:t.frameElement)&&void 0!==n?n:null}catch(e){}return i},r=e=>{var t;let n=null;try{n=null!==(t=e.frameElement)&&void 0!==t?t:null}catch(e){}return n},o=e=>!(!e.contentDocument||"complete"!==e.contentDocument.readyState)&&("about:blank"===e.src||"about:blank"!==e.contentDocument.location.href)},607:function(e,t,n){n.d(t,{dC:function(){return d},$4:function(){return c},kK:function(){return u},HS:function(){return l}});var i=n(191),r=n(5391),o=n(485);class s{constructor(e,t,n){this.active=!1,this.root=e,this.currentNode=e,this.whatToShow=null!=t?t:NodeFilter.SHOW_ALL,this.nodeFilter=null!=n?n:null}nextNode(){let e=this.currentNode,t=NodeFilter.FILTER_ACCEPT;for(;;){for(;t!==NodeFilter.FILTER_REJECT&&(null==e?void 0:e.firstChild);)if(e=e.firstChild,t=this.filter(e),t===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let n=null,i=e;for(;null!==i;){if(i===this.root)return null;if(n=i.nextSibling,null!==n){e=n;break}i=i.parentNode}if(t=this.filter(e),t===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e}}nextSibling(){let e=this.currentNode;if(e===this.root)return null;for(;;){let t=e.nextSibling;for(;null!==t;){e=t;const n=this.filter(e);if(n===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;t=e.firstChild,n!==NodeFilter.FILTER_REJECT&&null!==t||(t=e.nextSibling)}if(e=e.parentNode,null===e||e===this.root)return null;if(this.filter(e)===NodeFilter.FILTER_ACCEPT)return null}}parentNode(){let e=this.currentNode;for(;null!==e&&e!==this.root;)if(e=e.parentNode,null!==e&&this.filter(e)===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;return null}filter(e){if(this.active)throw new Error("CustomTreeWalker is in an invalid state.");const t=e.nodeType-1;if(!(this.whatToShow&1<<t))return NodeFilter.FILTER_SKIP;if(null===this.nodeFilter)return NodeFilter.FILTER_ACCEPT;this.active=!0;try{return this.nodeFilter.acceptNode(e)}finally{this.active=!1}}}s.createTreeWalker=(e,t,n)=>new s(e,t,n);const a=e=>{const t=[];let n=(0,r.Ng)(e)?e.host:e.parentNode;for(;n;){t.push(n);const e=n.parentNode;n=null===e&&((0,r.Ng)(n)||(0,r.iX)(n))?n.host:e}return t};function*u(e,t={}){const{recoverOnNotConnectedNodes:n,shouldProcessNode:i,useNativeTreeWalker:l}=t;if((0,o.O$)(e))return;if(i&&!i(e))return;const c=new Set,d=(l?document:s).createTreeWalker(e,NodeFilter.SHOW_ALL,{acceptNode(e){return c.has(e)||(0,o.O$)(e)?NodeFilter.FILTER_REJECT:i?i(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}});let g=d.currentNode;for(;g;){const e=a(g);if(yield g,(0,r.vq)(g)&&g.shadowRoot&&(yield*u(g.shadowRoot,t)),c.add(g),n)if(g.isConnected){const t=a(g);for(let n=0;n<e.length;n++){const i=e[n];if(t[n]!==i){d.currentNode=i;break}}}else{const t=e.find((e=>e.isConnected));if(!t)return;d.currentNode=t}g=(0,o.x)(d.currentNode)?d.nextSibling():d.nextNode()}}function*l(e,t=!1){if(t&&(0,r.Kc)(e))return;let n=(0,r.vq)(e)?e:d(e);for(;n;){if(yield n,t&&n.parentNode&&(0,r.Kc)(n.parentNode))return;n=d(n)}}const c=e=>{let t=e.parentNode;return null===t&&((0,r.Ng)(e)||(0,r.iX)(e)?t=e.host:(0,r.Kc)(e)&&(t=(0,i.ni)(e))),t},d=e=>{let t=e.parentElement;return null===t&&((0,r.Ng)(e)||(0,r.iX)(e)?t=e.host:e.parentNode&&(0,r.Kc)(e.parentNode)&&(t=(0,i.ni)(e.parentNode))),t}},5391:function(e,t,n){n.d(t,{A6:function(){return w},B6:function(){return I},Gr:function(){return N},JL:function(){return R},Jp:function(){return m},Kc:function(){return a},LY:function(){return S},Ll:function(){return c},Ng:function(){return d},PV:function(){return T},QU:function(){return y},ST:function(){return v},Wj:function(){return h},X:function(){return M},a8:function(){return u},bK:function(){return _},c8:function(){return E},gh:function(){return l},iX:function(){return g},im:function(){return b},ir:function(){return o},j1:function(){return s},kH:function(){return C},lg:function(){return f},oq:function(){return O},rh:function(){return p},sb:function(){return r},tm:function(){return L},vq:function(){return i}});const i=e=>(null==e?void 0:e.nodeType)===Node.ELEMENT_NODE,r=e=>void 0!==(null==e?void 0:e.dataset),o=e=>e.nodeType===Node.TEXT_NODE,s=e=>"TEXTAREA"===e.nodeName,a=e=>Boolean(e)&&(null==e?void 0:e.nodeType)===Node.DOCUMENT_NODE,u=e=>e.nodeType===Node.DOCUMENT_TYPE_NODE,l=e=>e.nodeType===Node.DOCUMENT_FRAGMENT_NODE,c=e=>void 0!==(null==e?void 0:e.nodeName),d=e=>"#document-fragment"===e.nodeName&&"ShadowRoot"===e.constructor.name,g=e=>"#document-fragment"===e.nodeName&&"ShadowRoot"!==e.constructor.name,f=e=>"HEAD"===e.nodeName,h=e=>"OBJECT"===e.nodeName,m=e=>"SELECT"===e.nodeName,v=e=>null!==e&&("STYLE"===e.nodeName||"style"===e.nodeName),p=e=>"SCRIPT"===e.nodeName||"NOSCRIPT"===e.nodeName,y=e=>"#comment"===e.nodeName,w=e=>"IMG"===e.nodeName,E=e=>"image"===e.nodeName,b=e=>"use"===e.nodeName,T=e=>"SOURCE"===e.nodeName,S=e=>"PICTURE"===e.nodeName,I=e=>"INPUT"===e.nodeName,O=e=>I(e)||s(e),R=e=>"LINK"===e.nodeName,N=e=>R(e)&&["stylesheet","alternate stylesheet"].includes(e.rel),C=e=>"META"===e.nodeName,M=e=>"TITLE"===e.nodeName,_=e=>"IFRAME"===e.nodeName;var L;!function(e){e.XLINK="http://www.w3.org/1999/xlink",e.XHTML="http://www.w3.org/1999/xhtml",e.XML="https://www.w3.org/XML/1998/namespace"}(L||(L={}))},1802:function(e,t,n){n.d(t,{Et:function(){return o},Gv:function(){return r},Kg:function(){return i},Lm:function(){return s}});const i=e=>"string"==typeof e;function r(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function o(e){return"number"==typeof e}function s(e){return"boolean"==typeof e}},3286:function(e,t,n){n.d(t,{Af:function(){return s},XV:function(){return r},dc:function(){return i},ei:function(){return a},hx:function(){return o}});const i=e=>{let t=null;try{t=window.localStorage.getItem(e)}catch(e){}return t},r=(e,t)=>{try{return window.localStorage.setItem(e,t),!0}catch(e){return!1}},o=e=>{try{window.localStorage.removeItem(e)}catch(e){}},s=e=>{let t=null;try{t=window.sessionStorage.getItem(e)}catch(e){}return t},a=(e,t)=>{try{return window.sessionStorage.setItem(e,t),!0}catch(e){return!1}}},5190:function(e,t,n){n.d(t,{Jb:function(){return r},TI:function(){return o},nA:function(){return s},zf:function(){return i}});const i=(e,t)=>{if(!t.document)return e;try{const n=t.document.createElement("a");return n.href=e,n.href}catch(t){if(t instanceof TypeError&&"can't access dead object"===t.message)return e;throw t}},r=e=>["chrome-extension://","moz-extension://"].some((t=>e.startsWith(t))),o=e=>{try{const{hostname:t}=new URL(e);return"localhost"===t||"127.0.0.1"===t}catch(e){return!1}},s=e=>e.startsWith("blob:")},3589:function(e,t,n){n.d(t,{NM:function(){return r},RT:function(){return s},VP:function(){return i},wp:function(){return o}});const i=e=>{try{return Boolean(e.location.href)}catch(e){return!1}},r=()=>{if(o())return!1;try{return Boolean(window.frameElement)}catch(e){return!1}},o=()=>window.top===window,s=()=>!o()}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={exports:{}};return n[e].call(o.exports,o,o.exports,r),o.exports}r.m=n,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return{171:"context-zone",461:"polyfills",630:"replay",914:"control"}[e]+"."+{171:"9eed48e17e0870077192",461:"454bab57fab8cfa33ca2",630:"ad852318479853bbbba8",914:"e02e9d793bcdbef3d71a"}[e]+".adrum.js"},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="@appd/js-agent-client:",r.l=function(n,i,o,s){if(e[n])e[n].push(i);else{var a,u;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(u=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+o),a.src=n,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous")),e[n]=[i];var g=function(t,i){a.onerror=a.onload=null,clearTimeout(f);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((function(e){return e(i)})),t)return t(i)},f=setTimeout(g.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=g.bind(null,a.onerror),a.onload=g.bind(null,a.onload),u&&document.head.appendChild(a)}},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),function(){if(void 0!==r){var e=r.u,t=r.e,n={},i={};r.u=function(t){return e(t)+(n.hasOwnProperty(t)?"?"+n[t]:"")},r.e=function(o){return t(o).catch((function(t){var s=i.hasOwnProperty(o)?i[o]:3;if(s<1){var a=e(o);throw t.message="Loading chunk "+o+" failed after 3 retries.\n("+a+")",t.request=a,t}return new Promise((function(e){setTimeout((function(){var t=Date.now();n[o]=t,i[o]=s-1,e(r.e(o))}),100)}))}))}}}(),function(){var e={792:0};r.f.j=function(t,n){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise((function(n,r){i=e[t]=[n,r]}));n.push(i[2]=o);var s=r.p+r.u(t),a=new Error;r.l(s,(function(n){if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=function(t,n){var i,o,s=n[0],a=n[1],u=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(u)u(r)}for(t&&t(n);l<s.length;l++)o=s[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunk_appd_js_agent_client=self.webpackChunk_appd_js_agent_client||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=r(5703),s=r(4318),a=r(2376),u=r(6022),l=r(9015),c=r(1802),d=r(4141),g=r(718),f=r(7599);const h=e=>Array.isArray(e)&&e.every((e=>"string"==typeof e||e instanceof RegExp)),m={appName:{invalidMessage:'Property "appName" must be a non-empty string.',isOptional:!1,test:e=>(0,c.Kg)(e)&&""!==e.trim()},appVersion:{invalidMessage:'Property "appVersion" must be a string.',isOptional:!0,test:c.Kg},aura:{invalidMessage:'Property "aura" must be a boolean.',isOptional:!0,test:c.Lm},disableLateResources:{invalidMessage:'Property "disableLateResources" must be a boolean.',isOptional:!0,test:c.Lm},exportersForDebug:{invalidMessage:'Property "exportersForDebug" must be a boolean.',isOptional:!0,test:c.Lm},exportForTests:{invalidMessage:'Property "exportForTests" must be a boolean.',isOptional:!0,test:c.Lm},exportInterval:{invalidMessage:'Property "exportInterval" must be a number, interval in milliseconds.',isOptional:!0,test:c.Et},exportTimeout:{invalidMessage:'Property "exportTimeout" must be a number, timeout in milliseconds.',isOptional:!0,test:c.Et},ignoreUrlsForFetch:{invalidMessage:'Property "ignoreUrlsForFetch" must be an array of strings or Regular expressions.',isOptional:!0,test:h},ignoreUrlsForResource:{invalidMessage:'Property "ignoreUrlsForResource" must be an array of strings or Regular expressions.',isOptional:!0,test:h},ignoreUrlsForXhr:{invalidMessage:'Property "ignoreUrlsForXhr" must be an array of strings or Regular expressions.',isOptional:!0,test:h},logLevel:{invalidMessage:'Property "logLevel" must be one of "debug" | "info" | "warn" | "error".',isOptional:!0,test:d.n},networkErrorTimeoutDuration:{invalidMessage:'Property "exportInterval" must be a number, timeout in milliseconds.',isOptional:!0,test:c.Et},sessionReplay:{invalidMessage:'Property "sessionReplay" must be an object.',isOptional:!0,nestedValidators:{iframeDiscoverParentTimeout:{invalidMessage:'Property "sessionReplay.iframeDiscoverParentTimeout" must be a number, timeout in milliseconds.',isOptional:!0,test:c.Et},iframes:{invalidMessage:'Property "iframes" must be a boolean.',isOptional:!0,test:c.Lm},maskAllInputs:{invalidMessage:'Property "sessionReplay.maskAllInputs" must be a boolean.',isOptional:!0,test:c.Lm},maskAllText:{invalidMessage:'Property "sessionReplay.maskAllText" must be a boolean.',isOptional:!0,test:c.Lm},packAssets:{invalidMessage:'Property "sessionReplay.packAssets" must be a boolean.',isOptional:!0,test:c.Lm},periodicDOMSnapshotInterval:{invalidMessage:'Property "sessionReplay.periodicDOMSnapshotInterval" must be a number, interval in milliseconds.',isOptional:!0,test:c.Et},sensitivityRules:{invalidMessage:'Property "sessionReplay.sensitivityRules" must be an array of objects in format [{ rule: mask | unmask | exclude, selector: string }]',isOptional:!0,test:e=>Array.isArray(e)&&e.every((e=>"object"==typeof e&&"rule"in e&&"string"==typeof e.rule&&g.g7.includes(e.rule)&&"selector"in e&&"string"==typeof e.selector))}},test:c.Gv},storageKeys:{invalidMessage:'Property "storageKeys" must be an object.',isOptional:!0,nestedValidators:{immatureSpan:{invalidMessage:'Property "storageKeys.immatureSpan" must be a string.',isOptional:!0,test:c.Kg},metadata:{invalidMessage:'Property "storageKeys.metadata" must be a string.',isOptional:!0,test:c.Kg},queuedChunks:{invalidMessage:'Property "storageKeys.queuedChunks" must be a string.',isOptional:!0,test:c.Kg},timeout:{invalidMessage:'Property "storageKeys.timeout" must be a string.',isOptional:!0,test:c.Kg}},test:c.Gv},url:{invalidMessage:'Property "url" must be an URL string.',isOptional:!1,test:f.gU},useZoneContext:{invalidMessage:'Property "useZoneContext" must be a boolean.',isOptional:!0,test:c.Lm}},v=(e,t)=>{let n=!0;return Object.keys(t).forEach((i=>{const r=i,o=t[r],s=e[r];if(void 0!==s){if(o.test&&!o.test(s))return n=!1,void(0,a.o)(o.invalidMessage);if("object"==typeof(u=o)&&null!==u&&"nestedValidators"in u){if(!(0,c.Gv)(s))return n=!1,void(0,a.o)(o.invalidMessage);n=v(s,o.nestedValidators)}else var u}else o.isOptional||(n=!1,(0,a.o)(o.invalidMessage))})),n};var p=r(9513),y=r(3286);const w=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return["anonymousUserId","createdAt","lastUpdatedAt","sessionId","previousSessions"].every((e=>t.includes(e)))},E=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return["headers","requestId","serviceClientType","data","timestamp","url"].every((e=>t.includes(e)))};class b{constructor(e){this.storageKeys=e,this.setProjectMetadata=(e,t)=>{const n=this.getMetadata();n[e]=Object.assign(Object.assign({},n[e]),t),this.set(this.storageKeys.metadata,JSON.stringify(n))},this.setTimeout=e=>{this.set(this.storageKeys.timeout,JSON.stringify(e))},this.updateProjectMetadata=(e,t)=>{const n=this.getProjectMetadata(e);n&&this.setProjectMetadata(e,Object.assign(Object.assign({},n),t))}}clearTimeout(){this.remove(this.storageKeys.timeout)}getProjectMetadata(e){var t;return null!==(t=this.getMetadata()[e])&&void 0!==t?t:null}getTimeout(){const e=this.get(this.storageKeys.timeout);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}getMetadata(){const e=this.get(this.storageKeys.metadata);if(!e)return{};try{const t=JSON.parse(e);return(e=>{if("object"!=typeof e||null===e||Array.isArray(e))return!1;for(const[t,n]of Object.entries(e)){if("string"!=typeof t)return!1;if(!w(n))return!1}return!0})(t)?t:(o.R.warn("Invalid metadata found in local storage",t),{})}catch(t){return o.R.warn("Malformed metadata found in local storage",e),{}}}}class T extends b{clear(){this.remove(this.storageKeys.metadata)}getImmatureSpanData(){const e=this.get(this.storageKeys.immatureSpan);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}getQueuedChunks(){const e=this.get(this.storageKeys.queuedChunks);if(!e)return null;try{const n=JSON.parse(e);return t=n,Array.isArray(t)&&t.every(E)?n.map((e=>Object.assign(Object.assign({},e),{data:new Uint8Array(e.data)}))):(o.R.warn("Invalid queued chunks found in local storage",n),null)}catch(t){return o.R.warn("Malformed queued chunks found in local storage",e),null}var t}queueChunkToSend(e){var t;const n=null!==(t=this.getQueuedChunks())&&void 0!==t?t:[];return n.push(e),this.setQueuedChunks(n),!0}removeImmatureSpanData(){this.remove(this.storageKeys.immatureSpan)}removeQueuedChunks(){this.remove(this.storageKeys.queuedChunks)}setImmatureSpanData(e){this.set(this.storageKeys.immatureSpan,JSON.stringify(e))}setQueuedChunks(e){0!==e.length?this.set(this.storageKeys.queuedChunks,JSON.stringify(e.map((e=>Object.assign(Object.assign({},e),{data:Array.from(e.data)}))))):this.removeQueuedChunks()}get(e){return(0,y.dc)(e)}remove(e){(0,y.hx)(e)}set(e,t){(0,y.XV)(e,t)}}class S{constructor(e){this.config=e,this.localStorage=new T(e.apiConfig.storageKeys)}clearStorage(){this.localStorage.clear()}clearTimeout(){this.localStorage.clearTimeout()}getImmatureSpanData(){return this.localStorage.getImmatureSpanData()}getMetadataForProject(){return this.localStorage.getProjectMetadata(this.config.projectKey)}getQueuedChunks(){var e;return null!==(e=this.localStorage.getQueuedChunks())&&void 0!==e?e:[]}getTimeout(){return this.localStorage.getTimeout()}persistImmatureSpanData(e){this.localStorage.setImmatureSpanData(e)}persistMetadata(e){this.localStorage.setProjectMetadata(this.config.projectKey,e)}persistTimeout(e){this.localStorage.setTimeout(e)}queueChunkToSend(e){return this.localStorage.queueChunkToSend(e)}removeImmatureSpanData(){this.localStorage.removeImmatureSpanData()}removeQueuedChunk(e){const t=this.getQueuedChunks().filter((t=>t.requestId!==e.requestId));this.localStorage.setQueuedChunks(t)}removeQueuedChunks(){this.localStorage.removeQueuedChunks()}updateProjectMetadata(e){this.localStorage.updateProjectMetadata(this.config.projectKey,e)}}class I{constructor(e){this.services=e,this.timeoutApplyListeners=[],this.timeoutExpirationListeners=[],this.timeoutMetadata=this.services.storageService.getTimeout(),this.timeoutMetadata&&(this.isTimeoutApplied()?(o.R.debug("Timeout found in storage.",{timeout:this.timeoutMetadata,timeRemaining:this.getTimeoutRemainingTime()}),this.attachTimeout(this.getTimeoutRemainingTime())):(this.timeoutMetadata=null,this.services.storageService.clearTimeout()))}addTimeoutApplyListener(e){this.timeoutApplyListeners.push(e)}addTimeoutExpirationListener(e){this.timeoutExpirationListeners.push(e)}applyTimeout(e,t=!0){o.R.debug("Applying timeout.",e),this.timeoutMetadata=Object.assign({createdAt:Date.now()},e),t&&this.services.storageService.persistTimeout(this.timeoutMetadata),this.timeoutApplyListeners.forEach((e=>e())),this.attachTimeout(e.duration)}isTimeoutApplied(){if(!this.timeoutMetadata)return!1;return this.getTimeoutRemainingTime()>0}attachTimeout(e){this.timeoutId&&(o.R.debug("Ban timeout already attached. Removing previous ban."),window.clearTimeout(this.timeoutId)),this.timeoutId=window.setTimeout((()=>{this.services.storageService.clearTimeout(),this.timeoutExpirationListeners.forEach((e=>e())),this.timeoutMetadata=null}),e)}getTimeoutRemainingTime(){if(!this.timeoutMetadata)return 0;const e=Date.now()-this.timeoutMetadata.createdAt;if(e<0)return 0;const t=Math.max(0,this.timeoutMetadata.duration-e);return Math.min(t,this.timeoutMetadata.duration)}}var O=r(4693),R=r(191),N=r(3906);class C extends Error{constructor(...e){super(...e),Object.setPrototypeOf(this,C.prototype)}}var M=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const _=window.parent===window.top?1e4:11e3,L=(0,d.i)("post-message-service");class P{constructor(e){this.config=e,this.discoveredIframeWindows=new Set,this.eventListenersByEventType=new Map,this.isClosed=!1,this.pendingEventsByMessageEventSource=new Map,this.waitingIframesForConfig=new Set,this.waitingListenersByEventType=new Map,this.waitingListenersByEventTypeByMessageEventSource=new Map,this.addPostMessageEventListener=(e,t)=>{const n=this.eventListenersByEventType.get(e);n?n.push(t):this.eventListenersByEventType.set(e,[t])},this.broadcastEventToAllDiscoveredIframes=e=>{this.discoveredIframeWindows.forEach((t=>{t.postMessage(e,"*")}))},this.clearDiscoveredIframeWindows=()=>{this.discoveredIframeWindows.clear()},this.close=()=>{this.isClosed=!0},this.createPostMessageEvent=()=>({key:this.config.projectKey}),this.isTherePendingEvent=(e,t)=>{var n;const i=this.pendingEventsByMessageEventSource.get(t);if(i){const t=(null!==(n=i.get(e))&&void 0!==n?n:[]).filter((t=>t.name===e));if(t.length>0)return t.length>1&&L.warn("Received multiple events. Taking first received."),!0}return!1},this.sendEventToSource=(e,t)=>{L.debug(`Sending ${e.name} event to source.`,e),t.postMessage(e,"*")},this.setRemoteConfig=e=>{this.remoteConfig=e,this.waitingIframesForConfig.forEach((t=>{this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.CONFIG,config:e}),t)})),this.waitingIframesForConfig.clear()},this.tryToDiscoverParent=e=>M(this,void 0,void 0,(function*(){L.debug("Sending discovered event to parent.",window.location.href),this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.DISCOVERED}),e);try{return L.debug("Waiting for acknowledged event from parent.",window.location.href),yield this.waitForEventFromSourceOrThrowAfterGivenTime(N.g4.ACKNOWLEDGED,e,this.config.apiConfig.sessionReplay.iframeDiscoverParentTimeout),!0}catch(e){return e instanceof C?L.debug("Could not receive `acknowledged` post message. Timeout exceeded.",window.location.href):L.warn("Error happened during receiving `acknowledged` post message from parent.",e,window.location.href,document.visibilityState),!1}})),this.tryToReceiveStartSessionMessageFromParent=e=>M(this,void 0,void 0,(function*(){try{L.debug("Waiting for start session event from parent.",window.location.href);const t=this.waitingStartSessionEvent;return t?(this.waitingStartSessionEvent=void 0,t):yield this.waitForEventFromSource(N.g4.START_SESSION,e)}catch(e){e instanceof C&&(L.debug("Could not receive post message in `init`. Timeout exceeded.",window.location.href),this.close()),L.warn("Error happened during receiving post message from parent in `init`. Continuing normal recording.",e,window.location.href,document.visibilityState)}})),this.tryToStartSessionInChild=(e,t)=>M(this,void 0,void 0,(function*(){const n=e.contentWindow;if(!n)return;L.debug("Handling iframe load.",e.src,e),this.sendDiscoveryEventIfNeeded(e),L.debug("Waiting for discovered event.",e.src,e);const i=yield this.waitForDiscoveredEvent(n);i&&(L.debug(`Received ${i.name} event.`),this.sendConfigEventIfNeeded(e),this.sendEventToSource(Object.assign(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.START_SESSION,browserInstanceId:l.$.id}),t),n))})),this.waitForEventFromSource=(e,t)=>M(this,void 0,void 0,(function*(){var n;const i=this.pendingEventsByMessageEventSource.get(t);if(i){const t=null!==(n=i.get(e))&&void 0!==n?n:[],r=t.filter((t=>t.name===e));if(r.length>0)return r.length>1&&L.warn("Received multiple events. Taking first received."),i.set(e,t.filter((t=>t.name!==e))),r[0]}let r=this.waitingListenersByEventTypeByMessageEventSource.get(t);void 0===r&&(r=new Map,this.waitingListenersByEventTypeByMessageEventSource.set(t,r));const o=yield new Promise((t=>{if(void 0===r)throw new Error("listenersByWindow is undefined");r.set(e,t)}));return r.delete(e),o})),this.waitForEventFromSourceOrThrowAfterGivenTime=(e,t,n=_)=>{const i=this.waitForEventFromSource(e,t),r=new Promise(((t,i)=>{setTimeout((()=>{i(new C(`Could not retrieve event ${e} in given time (${n}ms).`))}),n)}));return Promise.race([i,r])},this.postMessageEventListener=e=>{if(!(0,O.Q)(e))return;const t=e.data;if((0,N.GX)(t)&&e.source){const n=e.source;if(t.key!==this.config.projectKey)return void L.debug("Received event with different key.",e);(0,N.yv)(t)&&!this.isClosed&&(L.debug("Received getConfig. Sending config response",e),this.remoteConfig?this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.CONFIG,config:this.remoteConfig}),n):this.waitingIframesForConfig.add(n)),(0,N.MG)(t)&&!this.isClosed&&(L.debug("Received discovery. Sending discovered response",e),this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.DISCOVERED}),n)),(0,N.o7)(t)&&!this.isClosed&&(L.debug("Received discovered. Sending acknowledged response",e),this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.ACKNOWLEDGED}),n),this.discoveredIframeWindows.add(n)),(0,N.cS)(t)&&!this.isClosed&&(this.waitingStartSessionEvent=t);const i=this.eventListenersByEventType.get(t.name);if(i){L.debug(`Found listeners for event - ${e.data.name}.`,e);for(const t of i)t(e.data,n)}const r=this.waitingListenersByEventTypeByMessageEventSource.get(e.source);if(r){const n=r.get(t.name);n&&(L.debug(`Found waiting listener for event - ${t.name}.`,e),n(t))}const o=this.waitingListenersByEventType.get(t.name);if(o&&o.length>0&&(L.debug(`Found waiting listener from any source for event - ${t.name}.`,e),o.forEach((e=>e(t)))),r||i||o&&o.length>0)return;L.debug(`No pending listener found for ${t.name}.`);const s=this.pendingEventsByMessageEventSource.get(e.source);if(s){const e=s.get(t.name);e?(e.push(t),s.set(t.name,e)):s.set(t.name,[t])}else{const n=new Map;n.set(t.name,[t]),this.pendingEventsByMessageEventSource.set(e.source,n)}}},this.sendConfigEventIfNeeded=e=>{e.contentWindow&&!this.isTherePendingEvent(N.g4.GET_CONFIG,e.contentWindow)&&this.remoteConfig&&(L.debug("Iframe is not yet configured. Sending config event.",e.src,e),this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.CONFIG,config:this.remoteConfig}),e.contentWindow))},this.sendDiscoveryEventIfNeeded=e=>{e.contentWindow&&(this.isTherePendingEvent(N.g4.DISCOVERED,e.contentWindow)||(L.debug("Iframe is not yet discovered. Sending discovery event.",e.src,e),this.sendEventToSource(Object.assign(Object.assign({},this.createPostMessageEvent()),{name:N.g4.DISCOVERY}),e.contentWindow)))},this.waitForDiscoveredEvent=e=>M(this,void 0,void 0,(function*(){try{return yield this.waitForEventFromSourceOrThrowAfterGivenTime(N.g4.DISCOVERED,e)}catch(t){return t instanceof C?(L.debug("Could not receive discovered event from iframe.",e),null):(L.warn("Error happened during receiving post message from parent. Continuing normal recording.",t,window.location.href,R.ni(document)),null)}})),window.addEventListener("message",this.postMessageEventListener)}}var A=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const F=(e,t)=>A(void 0,void 0,void 0,(function*(){if(!v(e,m))return void(0,a.o)("Script is not going to be initialized.");if(!(e=>{var t,n;const i="adrum_test";try{return localStorage.setItem(i,i),localStorage.removeItem(i),!0}catch(r){try{if(null===(t=e.storageKeys)||void 0===t?void 0:t.queuedChunks)return localStorage.removeItem(null===(n=e.storageKeys)||void 0===n?void 0:n.queuedChunks),localStorage.setItem(i,i),localStorage.removeItem(i),!0}catch(e){}}return(0,a.o)("Local storage is not accessible."),!1})(e))return void(0,a.o)("Script is not going to be initialized.");const n=(0,p.T)(e,p._);(0,s.y)(document)||o.R.setLoggingLevel(n.apiConfig.logLevel);const i=new S(n),l=new I({storageService:i}),c=new P(n),{Control:d}=yield r.e(914).then(r.bind(r,2356)),g=yield d.create(n,{postMessageService:c,storageService:i,timeoutService:l});return l.addTimeoutApplyListener((()=>{u.C.isNormalMode&&g.stopRecording()})),l.addTimeoutExpirationListener((()=>A(void 0,void 0,void 0,(function*(){o.R.debug("Timeout expired. Starting recording."),g.isInitialized||g.initialize(t),u.C.isNormalMode&&(yield g.startRecording())})))),l.isTimeoutApplied()||(g.initialize(t),yield g.startRecording()),g}));var D=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const k=[];let x;const j=(e,...t)=>D(void 0,void 0,void 0,(function*(){if("init"!==e)(null==x?void 0:x.isInitialized)?"track"===e&&x.trackCustomEvent(...t):k.push([e,t]);else{const[e,n]=t;x=yield F(e,(()=>{(()=>{for(;k.length>0;){const[e,t]=k.shift();j(e,...t)}})(),null==n||n()}))}}));var B=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};o.R.enableGroupLogging(),(0,s.y)(document)&&o.R.setLoggingLevel("debug");B(void 0,void 0,void 0,(function*(){if(!Boolean(window.adrum))return void(0,a.o)("window.adrum object is not present.");if(Boolean(window.adrum.isLoaded))return void(0,a.o)("adrum.js script is already loaded.");const e=[{featureName:"BigInt",featureValue:window.BigInt},{featureName:"ResizeObserver",featureValue:window.ResizeObserver}].map((e=>!(e.featureValue&&String(e.featureValue).indexOf("[native code]")>=0)&&`Browser feature '${e.featureName}}' is not available.`)).filter((e=>!!e));if(e.length>0)return e.forEach((e=>{(0,a.o)(e)})),void(0,a.o)("Script is not going to be initialized.");var t,n;-1!==[window.requestIdleCallback,null===(t=Array.prototype)||void 0===t?void 0:t.flat,null===(n=Array.prototype)||void 0===n?void 0:n.flatMap,Object.fromEntries,Object.hasOwn].map(Boolean).indexOf(!1)&&(o.R.debug("Required APIs are not supported. Loading polyfills."),yield r.e(461).then(r.bind(r,9759))),D(void 0,void 0,void 0,(function*(){var e,t;const n=null!==(t=null===(e=window.adrum)||void 0===e?void 0:e.api)&&void 0!==t?t:[];window.adrum=j,window.adrum.isLoaded=!0,u.C.initialize(),u.C.isNormalMode&&(yield l.$.initialize()),n.forEach((e=>{const[t,...n]=[...e];window.adrum(t,...n)}))}))}))}();
//# sourceMappingURL=adrum.js.map